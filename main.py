import streamlit as st

# 학과별 이모지 매핑 정의 (지난번 코드에 몇 가지 더 추가했어요!)
major_emojis = {
    "경영학과": "💼", "컴퓨터공학과": "💻", "회계학과": "💰",
    "간호학과": "👩‍⚕️", "유아교육과": "🧸", "사회복지학과": "🤝",
    "심리학과": "🧠", "교육학과": "🍎", "문예창작학과": "✍️",
    "인공지능학과": "🤖", "통계학과": "📊", "기계공학과": "⚙️",
    "건축학과": "🏗️", "체육학과": "🏃‍♂️", "미술학과": "🎨",
    "디자인학과": "🖌️", "음악학과": "🎶", "철학과": "🤔",
    "수학과": "➕", "물리학과": "⚛️", "스포츠경영학과": "🏆",
    "마케팅학과": "📈", "경찰행정학과": "👮‍♀️", "연극영화학과": "🎭",
    "관광경영학과": "✈️", "실용음악과": "🎤", "광고홍보학과": "📣",
    "상담학과": "🗣️", "창업학과": "💡", "신문방송학과": "📺",
    "법학과": "⚖️", "행정학과": "🏛️", "외교학과": "🌍",
    "국어국문학과": "📚", "영어영문학과": "🇬🇧", "역사학과": "📜",
    "화학과": "🧪", "생명과학과": "🧬", "지구과학과": "🌎",
    "도시공학과": "🏙️", "조경학과": "🌳", "환경공학과": "🌿",
    "에너지공학과": "⚡", "식품영양학과": "🥗", "의학과": "🏥",
    "수의학과": "🐾", "약학과": "💊", "경영정보학과": "📊"
}

# MBTI 유형별 추천 학과 정의 (예시)
# 이 부분은 김하윤님이 생각하는 MBTI와 학과의 연관성에 따라 자유롭게 수정하고 추가해 보세요!
mbti_major_recommendations = {
    "ISTJ": "경영학과, 컴퓨터공학과, 회계학과 (실용적이고 체계적인 분야)",
    "ISFJ": "간호학과, 유아교육과, 사회복지학과 (타인을 돕고 돌보는 분야)",
    "INFJ": "심리학과, 교육학과, 문예창작학과 (통찰력과 사람 이해)",
    "INTJ": "컴퓨터공학과, 인공지능학과, 통계학과 (전략적이고 분석적인 분야)",
    "ISTP": "기계공학과, 건축학과, 체육학과 (실용적이고 활동적인 분야)",
    "ISFP": "미술학과, 디자인학과, 음악학과 (예술적이고 자유로운 분야)",
    "INFP": "문예창작학과, 철학과, 심리학과 (이상적이고 창의적인 분야)",
    "INTP": "수학과, 물리학과, 컴퓨터공학과 (논리적이고 이론적인 분야)",
    "ESTP": "스포츠경영학과, 마케팅학과, 경찰행정학과 (활동적이고 현실적인 분야)",
    "ESFP": "연극영화학과, 관광경영학과, 실용음악과 (사교적이고 경험을 중시하는 분야)",
    "ENFP": "광고홍보학과, 심리학과, 상담학과 (열정적이고 관계 지향적인 분야)",
    "ENTP": "창업학과, 신문방송학과, 경영학과 (새로운 아이디어를 탐구하는 분야)",
    "ESTJ": "경영학과, 법학과, 행정학과 (체계적이고 리더십이 요구되는 분야)",
    "ESFJ": "유아교육과, 간호학과, 사회복지학과 (사람들과 함께하고 협력하는 분야)",
    "ENFJ": "교육학과, 외교학과, 상담학과 (타인의 성장을 돕고 이끄는 분야)",
    "ENTJ": "경영학과, 정치외교학과, 법학과 (전략적이고 리더십을 발휘하는 분야)"
}

# MBTI 유형별 세부 특성 정의 및 관련 코멘트 (핵심 아이디어!)
# 이 부분의 특성과 코멘트를 상세하게 채울수록 앱의 완성도가 높아집니다.
mbti_sub_traits = {
    "ISTJ": {
        "traits": ["신중하고 책임감이 강함", "원칙과 사실을 중시함", "꼼꼼하고 현실적", "계획적이고 꾸준함"],
        "comments": {
            "신중하고 책임감이 강함": "맡은 일을 완벽하게 해내려는 책임감은 행정학과나 회계학과에서 정확성을 요구하는 업무에 강점이 됩니다.",
            "원칙과 사실을 중시함": "논리적이고 사실에 기반한 분석 능력은 컴퓨터공학이나 경영학에서 문제 해결에 큰 도움이 됩니다.",
            "꼼꼼하고 현실적": "세부 사항을 놓치지 않는 꼼꼼함은 시스템을 다루는 컴퓨터공학이나 데이터를 분석하는 회계학에서 빛을 발합니다.",
            "계획적이고 꾸준함": "꾸준히 목표를 향해 나아가는 끈기는 어떤 학과에서든 전문성을 기르는 데 필수적입니다."
        }
    },
    "ISFJ": {
        "traits": ["배려심 많고 성실함", "타인을 잘 보살핌", "협조적이고 겸손함", "규칙을 잘 지킴"],
        "comments": {
            "배려심 많고 성실함": "타인을 이해하고 배려하는 마음은 간호학이나 사회복지학에서 사람 중심의 서비스를 제공하는 데 강점이 됩니다.",
            "타인을 잘 보살핌": "돌봄과 지원을 제공하는 능력은 유아교육이나 간호학에서 따뜻한 전문가로 성장하는 데 유리합니다.",
            "협조적이고 겸손함": "공동체 내에서 조화롭게 협력하는 능력은 모든 학과에서 팀 프로젝트 수행에 큰 도움이 됩니다."
        }
    },
    "INFJ": {
        "traits": ["통찰력 있고 깊이 사색함", "이상적이고 의미를 추구함", "타인의 성장을 돕고 싶어함", "복잡한 문제에 관심 많음"],
        "comments": {
            "통찰력 있고 깊이 사색함": "사람의 심리를 깊이 탐구하는 능력은 심리학과에서 인간 행동의 원리를 이해하는 데 탁월합니다.",
            "이상적이고 의미를 추구함": "가치 있는 것을 추구하는 마음은 교육학이나 문예창작에서 세상에 긍정적인 영향을 미치는 데 기여할 수 있습니다."
        }
    },
    "INTJ": {
        "traits": ["전략적이고 비판적 사고", "새로운 시스템 설계에 능함", "지식 탐구에 열정적", "독립적이고 효율적"],
        "comments": {
            "전략적이고 비판적 사고": "문제를 분석하고 해결책을 제시하는 능력은 컴퓨터공학이나 통계학에서 복잡한 시스템을 구축하는 데 필수적입니다.",
            "새로운 시스템 설계에 능함": "기존의 틀을 깨고 새로운 것을 만들어내는 능력은 인공지능학이나 컴퓨터공학에서 혁신을 이끄는 데 좋습니다."
        }
    },
    "ISTP": {
        "traits": ["실용적이고 문제 해결 능력 뛰어남", "손으로 만들고 조작하는 것을 선호", "모험심 강하고 유연함", "논리적이고 객관적"],
        "comments": {
            "실용적이고 문제 해결 능력 뛰어남": "실제 문제를 해결하는 능력은 기계공학이나 건축학에서 실물을 설계하고 제작하는 데 큰 도움이 됩니다.",
            "손으로 만들고 조작하는 것을 선호": "직접 만들고 고치는 경험은 공학 분야나 체육 분야에서 실제 활동을 통해 배우는 데 유리합니다."
        }
    },
    "ISFP": {
        "traits": ["자유롭고 예술적 감각 뛰어남", "현재를 즐기고 자연을 사랑함", "온화하고 겸손함", "개성 표현을 중요시함"],
        "comments": {
            "자유롭고 예술적 감각 뛰어남": "자신을 표현하는 예술적인 감각은 미술학이나 디자인학에서 독창적인 결과물을 만들어내는 데 좋습니다.",
            "개성 표현을 중요시함": "자신만의 색깔을 드러내는 것은 음악이나 미술 분야에서 자신만의 세계를 구축하는 데 중요합니다."
        }
    },
    "INFP": {
        "traits": ["이상주의적이고 따뜻함", "창의적이고 상상력이 풍부함", "개인의 가치를 존중", "깊은 의미를 추구함"],
        "comments": {
            "이상주의적이고 따뜻함": "세상에 긍정적인 영향을 주고 싶은 마음은 문예창작이나 심리학에서 인간의 내면을 다루는 데 유리합니다.",
            "창의적이고 상상력이 풍부함": "새로운 아이디어를 만들고 표현하는 능력은 철학이나 문예창작에서 깊이 있는 사고를 하는 데 좋습니다."
        }
    },
    "INTP": {
        "traits": ["논리적이고 분석적 사고", "새로운 아이디어 탐구 즐김", "지적 호기심이 강함", "독립적으로 문제를 해결"],
        "comments": {
            "논리적이고 분석적 사고": "복잡한 이론과 원리를 이해하고 분석하는 능력은 수학이나 물리학에서 심층적인 연구를 하는 데 필수적입니다.",
            "지적 호기심이 강함": "끊임없이 배우고 탐구하려는 태도는 컴퓨터공학이나 물리학에서 새로운 지식을 창조하는 데 좋습니다."
        }
    },
    "ESTP": {
        "traits": ["현실적이고 활동적", "도전적이고 대범함", "순발력 있고 적응력 좋음", "사람들과 상호작용 즐김"],
        "comments": {
            "현실적이고 활동적": "몸으로 부딪히며 배우고 해결하는 방식은 스포츠경영이나 마케팅에서 역동적인 업무에 적합합니다.",
            "순발력 있고 적응력 좋음": "빠르게 변화하는 상황에 대처하는 능력은 경찰행정이나 마케팅에서 현장 대응에 강점이 됩니다."
        }
    },
    "ESFP": {
        "traits": ["사교적이고 즐거움을 추구", "주목받는 것을 좋아함", "자유롭고 즉흥적", "긍정적이고 낙천적"],
        "comments": {
            "사교적이고 즐거움을 추구": "사람들과 어울리고 에너지를 나누는 것은 연극영화학과나 관광경영에서 대중과 소통하는 데 유리합니다.",
            "주목받는 것을 좋아함": "무대 위에서 자신을 표현하는 것을 즐기는 것은 실용음악이나 연극영화학과에서 큰 강점이 됩니다."
        }
    },
    "ENFP": {
        "traits": ["열정적이고 상상력이 풍부함", "다양한 가능성 탐구 즐김", "사람들과의 소통 중요시", "영향력을 행사하고 싶어함"],
        "comments": {
            "열정적이고 상상력이 풍부함": "새로운 아이디어를 내고 이를 사람들에게 전달하는 능력은 광고홍보나 심리학에서 창의적인 활동에 좋습니다.",
            "사람들과의 소통 중요시": "다양한 사람들과 교류하며 그들의 이야기를 듣고 공감하는 것은 상담학이나 심리학에서 관계 형성에 강점이 됩니다."
        }
    },
    "ENTP": {
        "traits": ["아이디어가 많고 다재다능", "토론과 논쟁 즐김", "논리적이고 분석적", "새로운 도전 주저하지 않음"],
        "comments": {
            "아이디어가 많고 다재다능": "획기적인 아이디어를 제시하고 이를 실현하는 것은 창업학이나 신문방송학에서 혁신적인 역할을 하는 데 좋습니다.",
            "토론과 논쟁 즐김": "다양한 관점에서 문제를 분석하고 자신의 의견을 논리적으로 피력하는 것은 경영학이나 신문방송학에서 필요합니다."
        }
    },
    "ESTJ": {
        "traits": ["체계적이고 현실적", "리더십 있고 추진력 강함", "원칙과 질서를 중시", "효율성과 성과를 중요시"],
        "comments": {
            "체계적이고 현실적": "명확한 목표를 세우고 체계적으로 실행하는 능력은 경영학이나 행정학에서 조직을 효율적으로 운영하는 데 필수적입니다.",
            "리더십 있고 추진력 강함": "주도적으로 일을 이끌고 성과를 만들어내는 것은 법학이나 경영학에서 조직의 리더로 성장하는 데 유리합니다."
        }
    },
    "ESFJ": {
        "traits": ["사교적이고 친절함", "타인을 돕고 조화 추구", "헌신적이고 책임감 강함", "인간관계의 중요성 인지"],
        "comments": {
            "사교적이고 친절함": "사람들과 긍정적인 관계를 형성하고 협력하는 것은 유아교육이나 간호학에서 대인 관계 역량이 중요한 분야에 좋습니다.",
            "타인을 돕고 조화 추구": "다른 사람들을 돕고 공동체에 기여하고자 하는 마음은 사회복지학이나 교육학에서 따뜻한 전문가로 활동하는 데 유리합니다."
        }
    },
    "ENFJ": {
        "traits": ["타인의 성장을 돕고 싶어함", "감성적이고 통찰력 뛰어남", "설득력 있고 리더십 발휘", "사람들에게 긍정적 영향 주려 함"],
        "comments": {
            "타인의 성장을 돕고 싶어함": "다른 사람의 잠재력을 이끌어내고 성장시키는 데 관심이 있다면 교육학이나 상담학이 적합합니다.",
            "설득력 있고 리더십 발휘": "자신의 비전을 공유하고 사람들을 이끄는 능력은 외교학이나 교육학에서 긍정적인 변화를 만들어내는 데 좋습니다."
        }
    },
    "ENTJ": {
        "traits": ["확신 있고 추진력 강함", "목표 지향적이고 전략적", "타고난 리더십", "효율성을 극대화"],
        "comments": {
            "확신 있고 추진력 강함": "명확한 목표를 설정하고 이를 강력하게 밀어붙이는 것은 경영학이나 정치외교학과에서 큰 그림을 그리는 데 유리합니다.",
            "타고난 리더십": "사람들을 조직하고 이끄는 능력은 법학이나 경영학에서 중요한 의사결정을 내리는 위치에 적합합니다."
        }
    }
}


st.set_page_config(
    page_title="김하윤님의 MBTI 학과 추천 앱",
    page_icon="🎓"
)

st.title("🎓 나의 MBTI는 어떤 학과와 어울릴까? (세부 특성 선택)")
st.write("나의 MBTI 유형과 세부 특성을 선택하여, 어울리는 학과를 추천받으세요!")
st.write("❗ **이 추천은 참고용이며, 개인의 적성과 흥미가 가장 중요합니다!**")

st.markdown("---")

# 1. MBTI 유형 선택
selected_mbti_type = st.selectbox(
    "1단계: 당신의 MBTI 유형은 무엇인가요?",
    [""] + sorted(list(mbti_sub_traits.keys())), # 비어있는 값과 함께 정렬하여 표시
    index=0,
    placeholder="MBTI 유형을 선택해주세요"
)

selected_sub_traits = [] # 선택된 세부 특성 리스트 초기화

if selected_mbti_type:
    # 2. 선택된 MBTI 유형에 대한 세부 특성 리스트 가져오기
    current_mbti_info = mbti_sub_traits.get(selected_mbti_type)

    if current_mbti_info:
        st.subheader(f"2단계: **{selected_mbti_type}** 유형의 어떤 특성이 당신과 가장 잘 맞나요? (중복 선택 가능)")
        
        # 3. 세부 특성 선택 (multiselect 위젯 사용)
        selected_sub_traits = st.multiselect(
            " ", # 라벨 없이 공간만 두기
            current_mbti_info["traits"],
            default=[] # 초기 선택 없음
        )
        
        st.markdown("---")

        if selected_sub_traits:
            # 4. 학과 추천 및 맞춤형 피드백 제공
            st.markdown(f"### 🎉 당신의 MBTI는 **{selected_mbti_type}** 이며, 선택하신 특성들은 다음과 같습니다:")
            
            # 선택된 특성들을 리스트로 표시
            for trait in selected_sub_traits:
                st.markdown(f"- **{trait}**")

            st.markdown("---")

            # MBTI 추천 정보 가져오기 (이전 코드와 동일)
            full_recommendation_string = mbti_major_recommendations.get(selected_mbti_type, "정보 없음")
            
            # 추천 문자열을 학과 리스트 부분과 설명 부분으로 분리
            parts = full_recommendation_string.split('(')
            major_list_string = parts[0].strip()
            description_part = f"({parts[1]}" if len(parts) > 1 else ""

            # 개별 학과 이름 추출 및 이모지 추가
            individual_majors = [m.strip() for m in major_list_string.split(',')]
            
            formatted_majors_with_emojis = []
            for major in individual_majors:
                emoji = major_emojis.get(major, "❓") # major_emojis에 없는 학과는 '?'로 표시
                formatted_majors_with_emojis.append(f"{emoji} {major}")
            
            # 이모지가 추가된 학과 리스트를 하나의 문자열로 결합
            display_string = ", ".join(formatted_majors_with_emojis)
            
            st.info(f"**{selected_mbti_type}** 유형에게 추천하는 학과는 다음과 같습니다: **{display_string.strip()}**")
            
            # 세부 특성에 따른 맞춤형 코멘트 추가
            if selected_sub_traits and current_mbti_info["comments"]:
                st.markdown("#### 선택하신 특성들을 고려했을 때:")
                for trait in selected_sub_traits:
                    comment = current_mbti_info["comments"].get(trait)
                    if comment:
                        st.success(f"✔️ **'{trait}'** 특성은 '{comment}'")
                    else:
                        st.warning(f"👉 '{trait}' 특성에 대한 상세 설명이 아직 없습니다. (추가 필요)")
            
            # 유형 전체에 대한 설명 (괄호 안의 내용)
            if description_part:
                st.markdown("---")
                clean_description = description_part.strip('() ')
                st.write(f"💡 **{selected_mbti_type}** 유형은 일반적으로 **{clean_description}** 특성을 가집니다.")
            
            st.success("😊 진로 탐색은 흥미로운 여정이에요! 자신의 강점과 관심사를 찾아보세요.")
        else:
            st.info("⬆️ 당신의 **세부 특성**을 한 가지 이상 선택해주세요!")
    else:
        st.warning(f"선택하신 **{selected_mbti_type}** 유형에 대한 세부 특성 정보가 아직 없습니다. 데이터를 추가해주세요!")
else:
    st.info("⬆️ 먼저 당신의 **MBTI 유형**을 선택해주세요! 😊")

st.markdown("---")
st.caption("진로에 대한 고민은 언제든지 함께 나눌 수 있어요! 힘내세요, 김하윤님! 💪")
